# 第 5 章 用 MCP 幫 Claude Code 生出超能力


## 5-2 PlayWright MCP 伺服器

### 下載「臺灣房價地圖」專案

- [範例專案](https://github.com/FlagTech/test_buyhouse/tree/update_data)：

    ```
    git clone -b update_data https://github.com/FlagTech/test_buyhouse.git
    cd test_buyhouse
    ```

- 自動設定環境並執行：

    ```
    uv run wsgi.py
    ```

### Claude Code 的 MCP 安裝和管理

- Playwright MCP 的 GitHub：

    ```
    https://github.com/microsoft/playwright-mcp
    ```

- 安裝 Playwright MCP：

    ```
    cd test_buyhouse
    claude mcp add playwright npx @playwright/mcp@latest
    ```

- 確認安裝狀態：

    ```
    claude mcp get playwright
    ```

- 設定全域安裝：

    ```
    claude mcp add --scope user playwright -- npx @playwright/mcp@latest
    ```

- 管理 MCP 的命令：

    ```
    # 確認特定 MCP 工具的狀態
    claude mcp get <name>

    # 列出 MCP 工具清單
    claude mcp list

    # 刪除特定 MCP
    claude mcp remove <name>
    ```

### 測試 PlayWright MCP

- 範例 Prompt：
    ```
    > 請幫我使用 playwright 開啟瀏覽器, 進入鉅亨網,並給我今日的財經新聞
    ```
    ```    
    > 幫我進入到 XXX 的新聞網頁, 抓取內文並儲存成 txt 檔
    ```

> [!TIP]
> Claude Code 有對 MCP 工具輸出的 tokens 數量進行限制 (預設為 25,000 tokens)，如果 tokens 數量太大的話會發生錯誤。我們可在 Power Shell 下達以下指令修改 MCP 的 tokens 限制：
> ```
> [System.Environment]::SetEnvironmentVariable("MAX_MCP_OUTPUT_TOKENS", "90000", "User")

> ```

## 5-3 用 PlayWright MCP 測試網頁應用程式

### 透過 PlayWright MCP 進行自動化測試

- 範例 Prompt：
    ```
    > 請透過 playwright 開啟 http://127.0.0.1:5000/, 並測試我的網頁應用程式功能是否正常
    ```
    ```
    > 幫我點擊不同的縣市, 確認每個地區的房價能不能正常顯示
    ```
    ```
    > 請透過 SVG 地圖的元素來點擊, 例如搜尋高雄市
    ```

- 建立自動化測試的 Agent：

    ```
    測試我的網頁應用程式功能是否正常，請使用 Playwright MCP 做以下動作：
    1. 確認網站中的頁面可以正常切換
    2. 透過點擊 SVG 台灣地圖來切換縣市 (請透過元素屬性搜尋)，確認每個縣市的圖表正常顯示
    3. 確認每個 checkbox 的功能是否正常
    4. 選擇不同的房屋型態，確認數字變化
    5. 切換到 「買房 vs 租房」，測試不同收入、消費、投資報酬率，檢查圖表更新情況
    6. 匯出網路請求清單，並回報有無 4xx/5xx 錯誤
    ```
    ```
    > 使用 playwright-web-tester 來測試我的網站功能
    ```

## 5-4 把 Claude Code 當命令列版本的 AI 聊天機器人

### Desktop Commander MCP

- 安裝 Desktop Commander MCP：
    ```
    claude mcp add desktop-commander npx @wonderwhy-er/desktop-commander
    ```
### 檔案搜尋

```
> 我忘記之前提案的 PPT 放哪了，請幫我搜尋電腦中的相關檔案，並確認內容包含 「股票分析」
```

### 批次讀取檔案

```
> 請幫我讀取 "C:\Users\User\Desktop\F5394\CH_08\圖" 中的圖片內容
```

### 檔案整理分類

```
> 請幫我搜尋電腦中收據或發票相關的檔案，並移動到桌面上的收據資料夾
```

### 分析 CSV 檔

```
> 請幫我分析這份檔案 "C:\Users\User\Desktop\customer_orders.csv" 
```

### 系統與效能監控

```
> 請幫我檢查目前運行程式所使用的 CPU、記憶體佔比
```
```
> 幫我關閉 Steam
```
