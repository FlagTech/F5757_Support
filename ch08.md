# 第 8 章 實戰範例：YouTube 影片轉投影片

## 8-1 與 Claude Code 討論專案

### 初始化專案

- CLAUDE.md 內容：

    ```
    - 使用 uv 管理 Python 環境
    - 如果專案尚未建立虛擬環境，請使用 uv init 初始化環境
    - 如果要執行 python 程式，使用 uv run 執行
    - 使用 docstring 並以**繁體中文**記錄函數、類別說明
    ```

### 先規劃，後實作

- 範例 Prompt：

    ```
    > 我希望開發一個能夠將 YouTube 影片轉換為靜態閱讀版本 (投影片) 的 Web 應用程式。

    主要功能如下：
    1. YouTube 影片處理
    -支援透過 YouTube URL 來下載 YouTube 影片
    -取得標題、時長、縮圖等影片資訊
    -取得影片主要語言的字幕檔

    2. 字幕處理
    -支援多語言字幕 (zh-TW, zh-CN, en, ja, ko)
    -自動翻譯功能
    -時間軸同步處理

    3. 投影片生成
    -當字幕變換時，使用 ffmpeg 截取關鍵幀
    -可調整畫質 (360p/480p/720p/1080p)
    -圖片壓縮與最佳化

    請先思考，列出開發此應用的主要步驟、其他附加功能以及所使用的程式語言。
    ```

### 設計專案架構

- 與 Claude Code 進行討論、調整，擬定專案架構：

    ```
    > 前端使用 React、後端框架使用 FastAPI、字幕翻譯使用 deep-translator，請先設計專案架構，別開始實作
    ```

## 8-2 執行實作

```
> 請開始主功能的實作
```

### 安裝 ffmpeg

- 透過 scoop 命令來安裝 ffmpeg：

    ```
    scoop install ffmpeg
    ```

- 驗證安裝是否成功：

    ```
    ffmpeg -version
    ```

### 初步檢查與測試

- 執行應用程式 (以下為此次範例的啟動方法，請依照你的應用程式為主)：

    ```
    # 啟動後端
    cd backend
    uv run app.py

    # 啟動前端
    cd frontend
    npm start
    ```

- 初步除錯：
    ```
    > 後端執行有誤，請執行並進行測試
    ```

- 透過 Playwright 進行測試：
    ```
    > 請透過 Playwright 開啟此應用程式，並測試基本功能是否能正常運行 
    ```
    ```
    > https://www.youtube.com/watch?v=I40S5yBmaiw 請輸入這段影片網址，測試字幕和截圖功能是否正常 
    ```

## 8-3 應用程式除錯

### 讓 Claude Code 自行找出問題點

- 請 Claude Code 自行檢查錯誤：

> 找出字幕顯示錯誤的原因並進行修正

### 提供修正方向

- 「YouTube 自動產生字幕」 的問題修正
    ```
    > https://www.youtube.com/watch?v=9prXuVwptQ0 這部影片的字幕是透過 YT 自動產生，請下載檔案，並判斷跟手動上傳字幕處理邏輯上的差異 
    ```
    ```
    > 請幫我改進手動上傳和自動產生字幕的處理邏輯 
    ```
    ```
    > yt_dlp 有辦法自動辨識為手動上傳的字幕或者是自動產生嗎? 
    ```
    ```
    > 既然你知道 yt_dlp 可以區分字幕是否為自動產生，那你剛剛為什麼要額外寫 「透過逐字時間戳記標籤」 來判斷的程式
    ```
- 截圖時間點問題修正
    ```
    > 目前截圖時間點的判斷邏輯是什麼? 
    ```
    ```
    > 目前會有截圖和字幕時間差的問題，截圖不該跳過，並以字幕時間的中間點進行截圖 
    ```
## 8-4 完善專案各項功能

### 加入歷史紀錄功能

```
> 請在首頁加入側邊欄，對處理後的影片進行記錄
```

### AI 翻譯 & AI 大綱功能

```
> 我希望可以串接 GPT、Claude、Gemini 或本地 Ollama 來進行翻譯，使用者可以輸入 API Key 或本地模型來使用 AI 翻譯，請先上網搜尋它們最新提供的模型和串接方式 
```
```
> 請先進行後端的實作並測試 
```
```
> 實作前端 UI 
```

### 加入 AI 語音辨識字幕功能
```
> 目前的應用程式無法處裡沒有字幕的影片，有什麼方法可以改善? 
```
```
> 請實作方案3 
```